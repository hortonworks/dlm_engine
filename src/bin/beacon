#!/bin/bash
#
# Copyright  (c) 2016-2017, Hortonworks Inc.  All rights reserved.
# 
# Except as expressly permitted in a written agreement between you or your
# company and Hortonworks, Inc. or an authorized affiliate or partner
# thereof, any use, reproduction, modification, redistribution, sharing,
# lending or other exploitation of all or any part of the contents of this
# software is strictly prohibited.
#

# resolve links - $0 may be a softlink
PRG="${0}"

while [ -h "${PRG}" ]; do
  ls=`ls -ld "${PRG}"`
  link=`expr "$ls" : '.*-> \(.*\)$'`
  if expr "$link" : '/.*' > /dev/null; then
    PRG="$link"
  else
    PRG=`dirname "${PRG}"`/"$link"
  fi
done

BASEDIR=`dirname ${PRG}`
BASEDIR=`cd ${BASEDIR}/..;pwd`
export BEACON_CLUSTER HDP_VERSION HADOOP_HOME BEACON_VERSION

if [ x$HDP_VERSION != x ]; then
   export ARGS="-Dhdp.version=${HDP_VERSION} "
fi

if [ x$BEACON_VERSION != x ]; then
   export ARGS="$ARGS -Dbeacon.version=${BEACON_VERSION} "
fi

if [ $# != 1 ];
then
   echo "usage: $0 {start|stop}"
   exit 1
fi

if [ x$1 = "xstart" ]; then
   $BASEDIR/bin/beacon_start.py $ARGS
elif [ x$1 = "xstop" ]; then
   $BASEDIR/bin/beacon_stop.py
else
   echo "usage: $0 {start|stop}"
   exit 1
fi
